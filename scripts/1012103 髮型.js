/**
 * 換髮型 NPC
 */
var status = -1;
var beauty = 0; // 剪髮或染髮
var hair_Colo_new;
var maleHairstyle = [
  31450, 40630, 43660, 40650, 43010, 40010, 40740, 40640, 40570, 43780, 43740,
  40820, 45120, 45140, 40110, 40580, 43810, 40020, 40030, 40040, 43120, 43140,
  45050, 45100, 33400, 37660, 36710, 36720, 36730, 36740, 36750, 36760, 36770,
  36780, 36790, 36800, 36810, 36820, 36830, 36840, 36850, 36860, 36870, 36880,
  36890, 36900, 36910, 36920, 36930, 36940, 36950, 36980, 36990, 36620, 36630,
  36640, 36650, 36670, 36680, 36690, 36700, 36010, 36020, 36030, 36050, 36070,
  36080, 36090, 36100, 36110, 36120, 36130, 36140, 36150, 36160, 36170, 36180,
  36190, 36200, 36210, 36220, 35700, 35710, 35720, 35730, 35740, 35700, 35750,
  35760, 35770, 35780, 35790, 35800, 35020, 35030, 35040, 35050, 35060, 35070,
  35090, 35100, 35110, 35120, 35130, 35140, 35150, 35160, 35170, 35180, 35190,
  35220, 35230, 35240, 35250, 35460, 35470, 35490, 35500, 35510, 35520, 35530,
  35540, 35550, 35560, 35570, 35580, 35590, 35600, 30030, 30020, 30000, 30310,
  30330, 30060, 30150, 30410, 30210, 30140, 30120, 30200, 30230, 30240, 30250,
  30260, 30270, 30340, 30680, 30630, 30670, 30700, 30730, 30760, 30770, 30720,
  30800, 30810, 33150, 33160, 33170, 33200, 33210, 33220, 34000, 34040, 40100,
  40250, 40260, 40270, 40290, 40330, 40350, 40350, 40360, 40390, 43010,
];
var femaleHairstyle = [
  32650, 41000, 41340, 41470, 41860, 41890, 41960, 41970, 44500, 44510, 44610,
  44820, 44850, 47080, 47090, 47290, 47420, 48020, 48060, 32660, 31520, 31510,
  31460, 31470, 31480, 37500, 37210, 38580, 37530, 37230, 37310, 37320, 37340,
  37350, 37370, 37380, 37400, 37410, 37420, 37430, 37440, 37450, 37460, 37480,
  37490, 37510, 37520, 37540, 37550, 37570, 37630, 37640, 37650, 37670, 37680,
  37690, 37700, 37180, 37200, 37240, 37250, 37260, 37270, 37280, 37290, 37300,
  37110, 37120, 37130, 37140, 37010, 37020, 37030, 37040, 37050, 37060, 37080,
  37070, 37090, 37100, 34510, 34470, 34490, 34230, 34240, 34250, 34260, 34270,
  34280, 34290, 34300, 34310, 34320, 34330, 34350, 34360, 34370, 34380, 34400,
  34410, 34420, 34430, 34440, 34450, 31050, 31040, 31000, 31150, 31310, 31300,
  31160, 31100, 31410, 31030, 31550, 31560, 31570, 31580, 31590, 31600, 31610,
  31620, 31630, 31640, 31650, 31670, 31680, 31690, 31700, 31710, 31720, 31730,
  31740, 31750, 31760, 31770, 31780, 31790, 31800, 31810, 31820, 31830, 31840,
  31850, 31860, 31870, 31880, 31890, 31910, 31930, 31940, 31950, 31990, 34120,
  34170, 34200, 34210, 34220,
];

function start() {
  action(1, 0, 0);
}

function action(mode, type, selection) {
  if (mode == 0) {
    cm.dispose();
    return;
  } else {
    status++;
  }

  if (status == 0) {
    cm.sendSimple(
      "你想不想換個帥氣、美麗的造型呢？只需要#r1#b#t4001126##k，本設計師就為您做造型！ \r\n#L0#剪髮: #i4001126##t4001126##l\r\n#L1#染髮: #i4001126##t4001126##l"
    );
  } else if (status == 1) {
    if (selection == 0) {
      // 剪髮
      var hair = cm.getPlayerStat("HAIR");
      hair_Colo_new = [];
      beauty = 1;
      // 男生
      if (cm.getPlayerStat("GENDER") == 0) {
        hair_Colo_new = maleHairstyle;
      } else {
        // 女生
        hair_Colo_new = femaleHairstyle;
      }
      for (var i = 0; i < hair_Colo_new.length; i++) {
        hair_Colo_new[i] = hair_Colo_new[i] + (hair % 10);
      }
      cm.askAvatar(
        "想換成哪種很棒的髮型呢 只要有 #b#t4001126##k 我就可以幫你換一個很棒的髮型喔！",
        hair_Colo_new
      );
    } else if (selection == 1) {
      // 染髮
      var currenthaircolo = Math.floor(cm.getPlayerStat("HAIR") / 10) * 10;
      hair_Colo_new = [];
      beauty = 2;

      for (var i = 0; i < 8; i++) {
        hair_Colo_new[i] = currenthaircolo + i;
      }
      cm.askAvatar("你想染成什麼顏色?", hair_Colo_new);
    }
  } else if (status == 2) {
    if (beauty == 1) {
      if (cm.setAvatar(4001126, hair_Colo_new[selection]) == 1) {
        cm.sendOk("享受你的新髮型吧！");
        cm.dispose();
      } else {
        cm.sendOk("看來我沒辦法幫你剪頭髮喔！");
        cm.dispose();
      }
    } else {
      if (cm.setAvatar(4001126, hair_Colo_new[selection]) == 1) {
        cm.sendOk("享受你的新髮色吧！");
        cm.dispose();
      } else {
        cm.sendOk("看來我沒辦法幫你染頭髮喔！");
        cm.dispose();
      }
    }
    cm.dispose();
  }
}
