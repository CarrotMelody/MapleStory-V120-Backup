var status = -1;
var GachItem = new Array([1012157, 100, true]);
var itemList = new Array(
  1112414,
  1022097,
  1702256,
  1702257,
  1702258,
  1702259,
  1702260,
  1102040,
  1102041,
  1102042,
  1102043,
  1102357,
  1102390,
  1102430,
  1122000,
  1482073,
  1492073,
  1122075,
  1122077,
  1472111,
  1302142,
  1312056,
  1322084,
  1332114,
  1372071,
  1382093,
  1402085,
  1412055,
  1422057,
  1432075,
  1452100,
  1442104,
  1462085,
  1082243,
  1082242,
  1082241,
  1082240,
  1082239,
  1082244,
  1082245,
  1072275,
  1072369,
  1132000,
  1132002,
  1132001,
  1132003,
  1132004,
  1132012,
  2041200,
  1492023,
  1332074,
  1442063,
  1462050,
  1452057,
  1472068,
  1432047,
  1422037,
  1412033,
  1402046,
  1302081,
  1312037,
  1322060,
  1332073,
  1372044,
  1382057,
  1072355,
  1072356,
  1072357,
  1072358,
  1072359,
  1092057,
  1092059,
  1092058,
  1052155,
  1052156,
  1052157,
  1052158,
  1052159,
  1082234,
  1082235,
  1082237,
  1082236,
  1082238,
  1002776,
  1002777,
  1002778,
  1002779,
  1002780,
  1122000,
  1122017,
  1332101,
  2070019,
  2049100,
  1012164,
  1012167,
  1012168,
  1012169,
  1012170,
  1012171,
  1012172,
  1012173,
  1012174,
  1122023,
  1122038,
  1122037,
  1122036,
  1122035,
  1122034,
  1012157,
  1112915,
  1002858,
  1002859,
  1002860,
  1002861,
  1492073,
  1482073,
  1302143,
  1402085,
  1372071,
  1382093,
  1312056,
  1412055,
  1322084,
  1422057,
  1332114,
  1472111,
  1432075,
  1452100,
  1442104,
  1462085
);

function action(mode, type, selection) {
  if (mode == 1) {
    status++;
  } else {
    cm.dispose();
    return;
  }
  if (status == 0) {
    if (cm.haveItem(5220000, 1)) {
      cm.sendYesNo(
        "您身上有#b#t5220000##i5220000##k可以進行轉蛋。\r\n你確定要使用 #b潮流轉蛋機#k 進行轉蛋嗎?"
      );
    } else {
      cm.sendOk("不好意思!您沒有#b#t5220000##i5220000##k。");
      cm.safeDispose();
    }
  } else if (status == 1) {
    var item;
    var gain = false;
    for (var i = 0; i < GachItem.length; i++) {
      var GItem = GachItem[i];
      if (Math.floor(Math.random() * GItem[1]) == 0) {
        item = cm.gainGachaponItem(GItem[0], 1, GItem[2]);
        gain = true;
        break;
      }
    }
    if (!gain) {
      item = cm.gainGachaponItem(
        itemList[Math.floor(Math.random() * itemList.length)],
        1
      );
    }

    if (item != -1) {
      cm.gainItem(5220000, -1);
      cm.sendOk("您已獲得 #b#t" + item + "##i" + item + "##k");
    } else {
      cm.sendOk("檢查一下背包是否已滿。");
    }
    cm.safeDispose();
  }
}

//黃金楓葉武器系列 1492073,1482073,1302143,1402085,1372071,1382093,1312056,1412055,1322084,1422057,1332114,1472111,1432075,1452100,1442104,1462085
//蓋瑞帽子系列 1002858,1002859,1002860,1002861
//鬼恰系列 1012164,1012167,1012168,1012169,1012170,1012171,1012172,1012173,1012174
//楓葉之心系列 1122023,1122038,1122037,1122036,1122035,1122034
//卷軸 2049100
//永恆系列 1492023,1332074,1442063,1462050,1452057,1472068,1432047,1422037,1412033,1402046,武器//1072355,1072356,1072357,1072358,1072359,1092057,1092059,1092058,1052155,1052156,1052157,1052158,1052159,1002776,1002777,1002778,1002779,1002780,1082234,1082235,1082237,1082236,1082238
