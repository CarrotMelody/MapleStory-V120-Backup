/* 玩具轉蛋機 */

var status = -1;
var GachItem = new Array([1012157, 100, true]);
var itemList = new Array(
	1012058,
	1012059,
	1012060,
	1012061,
	1012139,
	1012140,
	1482025,
	1002455,
	1002452,
	1442018,
	1102041,
	1102082,
	1002587,
	1072376,
	1902002,
	1902013,
	1102248,
	1003114,
	1912009,
	1302021,
	1302024,
	1302049,
	1302063,
	1302061,
	1312014,
	1312013,
	1312012,
	1322003,
	1322027,
	1322051,
	1332020,
	1332021,
	1332030,
	1332032,
	1442057,
	1442056,
	1442055,
	1442054,
	1442039,
	1432039,
	1432013,
	1422031,
	1422032,
	1422011,
	1422036,
	1402044,
	1402014,
	1402013,
	1372017,
	1372033,
	1332053,
	1302087,
	1302116,
	1302109,
	1302108,
	1302087,
	1112915
);
function action(mode, type, selection) {
  if (mode == 1) {
    status++;
  } else {
    cm.dispose();
    return;
  }
  if (status == 0) {
    if (cm.haveItem(5220000, 1)) {
      cm.sendYesNo(
        "您身上有#b#t5220000##i5220000##k可以進行轉蛋。\r\n你確定要使用 #b玩具轉蛋機#k 進行轉蛋嗎?\r\n#r獎池內含：橡皮榔頭、紙劍、光鞭、聖誕樹...等"
      );
    } else {
      cm.sendOk("不好意思!您沒有#b#t5220000##i5220000##k。");
      cm.safeDispose();
    }
  } else if (status == 1) {
    var item;
    var gain = false;
    for (var i = 0; i < GachItem.length; i++) {
      var GItem = GachItem[i];
      if (Math.floor(Math.random() * GItem[1]) == 0) {
        item = cm.gainGachaponItem(GItem[0], 1, GItem[2]);
        gain = true;
        break;
      }
    }
    if (!gain) {
      item = cm.gainGachaponItem(
        itemList[Math.floor(Math.random() * itemList.length)],
        1
      );
    }

    if (item != -1) {
      cm.gainItem(5220000, -1);
      cm.sendOk("您已獲得 #b#t" + item + "##i" + item + "##k");
    } else {
      cm.sendOk("檢查一下背包是否已滿。");
    }
    cm.safeDispose();
  }
}

//黃金楓葉武器系列 1492073,1482073,1302143,1402085,1372071,1382093,1312056,1412055,1322084,1422057,1332114,1472111,1432075,1452100,1442104,1462085
//蓋瑞帽子系列 1002858,1002859,1002860,1002861
//鬼恰系列 1012164,1012167,1012168,1012169,1012170,1012171,1012172,1012173,1012174
//楓葉之心系列 1122023,1122038,1122037,1122036,1122035,1122034
//卷軸 2049100
//永恆系列 1492023,1332074,1442063,1462050,1452057,1472068,1432047,1422037,1412033,1402046,
//武器 1072355,1072356,1072357,1072358,1072359,1092057,1092059,1092058,1052155,1052156,1052157,1052158,1052159,1002776,1002777,1002778,1002779,1002780,1082234,1082235,1082237,1082236,1082238
//椅子 3010002,3010003,3010004,3010005,3010006,3010007,3010008,3010009,3010010,3010012,3010013,3010014,3010015,3010017,3010016,3010018,3010019,3010020,3010021,3010022,3010023,3010024,3010025,3010026,3010027,3010028,3010029,3010030,3010031,3010032,3010033,3010034,3010035,3010036,3010037,3010038,3010039,3010040,3010041,30100422,3010043,3010044,3010045,3010046,3010047,3010048,3010049,3010050,3010051,3010052,3010053,3010054,3010055,3010056,3010057,3010058,3010059,3010060,3010061,3010062,3010063,3010064,3010065,3010066,3010067,3010068,3010069,3010070,3010071,3010072,3010073,3010074,3010075,3010077,3010076,3010078,3010079,3010080,3010081,3010082,3010083,3010084,3010085,3010086,3010087,3010088,3010089,3010090,3010091,3010092,3010093,3010094,3010095,3010096,3010097,3010098,3010099,3010100,3010101,3010102,3010103,3010104,3010105,3010106,3012002,3012003,3012004,3012005,3012006,3012007,3012008,3012009,3010110,3010111,3010112,3010113,3010114,3010115
//玩具 1302021,1302024,1302049,1302063,1302061,1312014,1312013,1312012,1322003,1322027,1322051,1332020,1332021,1332030,1332032,1442057,1442056,1442055,1442054,1442039,1432039,1432013,1422031,1422032,1422011,1422036,1402044,1402014,1402013,1372017,1372033,1332053
